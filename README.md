# Система управления заказами копицентра "КопиПейст"

Полнофункциональная система управления заказами для копицентра с поддержкой ролей: Клиент, Исполнитель, Администратор.

## 3. Технологический стек (3.1 Выбор состава технических и программных средств)

### Программное обеспечение для разработки
- **PHP 8.2+** — основной серверный язык
- **HTML5** — структура веб-страниц
- **CSS3** — стилизация
- **JavaScript ES6+** — клиентская логика

### Серверные фреймворки и платформы
- **Laravel** — основной PHP-фреймворк (в проекте: чистый PHP + PDO; миграция на Laravel возможна)
- **Node.js 18+** — для реального времени и инструментов сборки

### Клиентские фреймворки и библиотеки
- **Bootstrap** — CSS-фреймворк для адаптивного дизайна
- **Vue.js** — прогрессивный JavaScript-фреймворк (в проекте: Alpine.js для реактивности)
- **jQuery** — для кроссбраузерной совместимости
- **Alpine.js** — для реактивности без сложной настройки

### База данных и кэширование
- **MySQL** — основная СУБД
- **Redis** — для кэширования и сессий

### Серверное окружение
- **Nginx** — веб-сервер
- **PHP-FPM** — обработчик PHP
- **MySQL** — СУБД

### Ключевые библиотеки и инструменты
**Для разработки:**
- **Composer** — менеджер зависимостей PHP
- **NPM** — менеджер пакетов JavaScript
- **Vite** — сборщик фронтенд-ресурсов

**Для работы с MySQL:**
- **PDO MySQL (mysqlnd)** — нативный драйвер PHP для MySQL
- **Laravel Eloquent ORM** — основной ORM в Laravel (в проекте: PDO)
- **MySQLi** — улучшенное расширение для работы с MySQL

**Специализированные библиотеки для типографии:**
- **Intervention Image** — обработка изображений и превью макетов

**Инструменты разработки:**
- **VS Code** — IDE
- **Git** — система контроля версий

### Преимущества выбранного ПО для предприятия
- **Экономическая эффективность:** бесплатный стек (PHP, MySQL) минимизирует лицензионные расходы; открытый исходный код позволяет адаптацию под процессы типографии.
- **Производительность и масштабируемость:** MySQL надёжно хранит данные заказов; Redis-кэширование ускоряет загрузку каталога услуг и цен.
- **Функциональность для типографии:** Intervention Image позволяет создавать превью макетов прямо в браузере.
- **Безопасность данных:** защита от SQL-инъекций, XSS, CSRF; миграции БД обеспечивают целостность при обновлениях; ролевая модель доступа для разграничения прав сотрудников.
- **Адаптивность и доступность:** PWA-возможности для мобильного доступа к системе заказов; кроссбраузерная совместимость.

## Возможности

### Для клиентов:
- Выбор локации копицентра
- Просмотр каталога услуг с описанием и ценами
- Создание заказов с указанием параметров (формат, количество, тип печати)
- Прикрепление файлов для печати
- Указание сроков выполнения и особых пожеланий
- Просмотр истории заказов
- Отслеживание статуса заказа в реальном времени
- Чат с исполнителем
- Оценка качества работы
- Онлайн-оплата заказов

### Для исполнителей:
- Просмотр доступных заказов
- Взятие заказов в работу
- Изменение статуса заказов
- Просмотр деталей заказа и файлов клиента
- Загрузка промежуточных результатов
- Чат с клиентом
- Рабочий журнал
- Запросы к администратору при возникновении проблем

### Для администраторов:
- Просмотр всех заказов (актуальных и архивных)
- Редактирование параметров заказов
- Переназначение исполнителей
- Архивирование и восстановление заказов
- Управление пользователями (клиенты, исполнители, администраторы)
- Управление услугами и прайс-листом
- Управление локациями копицентра
- Обработка запросов от исполнителей
- Формирование отчетов и аналитика
- Статистика по заказам, исполнителям и услугам

## Установка

1. **Импорт базы данных:**
   - Откройте phpMyAdmin или другой инструмент для работы с MySQL
   - Создайте базу данных `copypasteDB`
   - Импортируйте файл `database/schema.sql`

2. **Настройка подключения:**
   - Откройте файл `function/connect.php`
   - Проверьте параметры подключения к БД:
     - `$host` - адрес сервера MySQL (обычно `127.0.0.1` или `localhost`)
     - `$port` - порт MySQL (обычно `3306`)
     - `$db` - имя базы данных (`copypasteDB`)
     - `$user` - пользователь MySQL (обычно `root`)
     - `$pass` - пароль MySQL

3. **Создание папки для загрузок:**
   - Создайте папку `uploads/orders/` в корне проекта
   - Установите права на запись для этой папки (chmod 755 или 777)

4. **Настройка веб-сервера:**
   - PHP 8.2 или выше
   - Расширения: `pdo`, `pdo_mysql`, `fileinfo`, `gd` (для Intervention Image)
   - Nginx + PHP-FPM или встроенный сервер PHP

5. **Зависимости PHP (Composer):**
   ```bash
   composer install
   ```
   Устанавливаются: intervention/image, predis/predis.

6. **Фронтенд (опционально, для сборки Bootstrap/Alpine через Vite):**
   ```bash
   npm install
   npm run build
   ```
   Или используются CDN (Bootstrap и Alpine уже подключены в разметке).

## Структура проекта

```
copypaste/
├── admin/              # Панель администратора
│   ├── index.php       # Главная страница админки
│   ├── orders.php      # Управление заказами
│   ├── users.php       # Управление пользователями
│   ├── services.php    # Управление услугами
│   ├── locations.php   # Управление локациями
│   ├── reports.php     # Отчеты и аналитика
│   └── requests.php    # Запросы от исполнителей
├── executor/           # Панель исполнителя
│   ├── index.php       # Главная страница исполнителя
│   ├── order_detail.php # Детали заказа
│   ├── chat.php        # Чат с клиентом
│   └── admin_requests.php # Запросы к администратору
├── profile/            # Личный кабинет клиента
│   ├── index.php       # Список заказов
│   ├── order_detail.php # Детали заказа
│   ├── chat.php        # Чат с исполнителем
│   ├── review.php      # Оценка заказа
│   └── payment.php     # Оплата заказа
├── orders/             # Создание заказов
│   └── create.php      # Форма создания заказа
├── function/           # Вспомогательные функции
│   ├── connect.php     # Подключение к БД
│   ├── auth.php        # Авторизация и права доступа
│   ├── file_upload.php # Загрузка файлов
│   └── helpers.php     # Вспомогательные функции
├── css/                # Стили (CSS3)
│   └── style.css       # Основной файл стилей
├── function/           # Вспомогательные функции
│   ├── layout_head.php # Подключение Bootstrap (стек)
│   ├── layout_footer.php # Подключение Bootstrap JS, Alpine.js
│   ├── image_helper.php  # Intervention Image (превью)
│   └── session_redis.php # Описание Redis для сессий
├── resources/          # Исходники для Vite
│   ├── js/app.js       # Bootstrap + Alpine.js (ES6+)
│   └── css/app.scss    # Bootstrap SCSS
├── composer.json       # PHP 8.2+, intervention/image, predis
├── package.json        # NPM: Bootstrap, Alpine.js, Vite
├── vite.config.js      # Сборка фронтенда
├── database/           # База данных
│   └── schema.sql      # SQL схема БД
├── index.php           # Главная страница
├── login/              # Вход в систему
├── register/           # Регистрация
└── logout.php          # Выход из системы
```

## Роли пользователей

1. **Клиент (role_id = 1)** - может создавать заказы, просматривать историю, общаться с исполнителем, оценивать и оплачивать заказы
2. **Исполнитель (role_id = 2)** - может брать заказы в работу, изменять статусы, общаться с клиентами, загружать результаты
3. **Администратор (role_id = 3)** - полный доступ ко всем функциям системы

## Статусы заказов

1. В обработке - заказ принят, ожидает назначения исполнителя
2. Назначен - исполнитель назначен, заказ в очереди
3. В работе - заказ выполняется
4. Готов - заказ выполнен и готов к выдаче
5. Выполнен - заказ выполнен и выдан клиенту
6. Отменен - заказ отменен

## Безопасность

- Все пароли хешируются с помощью `password_hash()`
- Используются подготовленные запросы (prepared statements) для защиты от SQL-инъекций
- Проверка прав доступа на каждой странице
- Валидация загружаемых файлов
- Защита от XSS через `htmlspecialchars()`

## Примечания

- В демонстрационной версии платежи выполняются автоматически (без реальной интеграции с платежными системами)
- Для продакшена рекомендуется добавить:
  - Реальную интеграцию с платежными системами
  - Email-уведомления
  - Логирование действий
  - Резервное копирование БД
  - HTTPS для безопасности

## Лицензия

Проект создан для демонстрационных целей.
